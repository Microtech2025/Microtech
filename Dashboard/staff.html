<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Management - MicroTech Center</title>
    <link rel="stylesheet" href="css/staff.css">
    <link rel="stylesheet" href="css/notifications.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Left Sidebar -->
        <div class="left-sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="logo-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <div class="logo-text">MicroTech Center</div>
                </div>
                <div class="sidebar-subtitle">Staff Management System</div>
            </div>
            
            <div class="sidebar-search">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" placeholder="Search staff...">
                </div>
            </div>
            
            <nav class="nav-menu">
                <a href="admin-dashboard.html" class="nav-item">
                    <i class="fas fa-home nav-icon"></i>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="revenue.html" class="nav-item">
                    <i class="fas fa-dollar-sign nav-icon"></i>
                    <span class="nav-text">Revenue Management</span>
                </a>
                <a href="student.html" class="nav-item">
                    <i class="fas fa-users nav-icon"></i>
                    <span class="nav-text">Students</span>
                </a>
                <a href="staff.html" class="nav-item active">
                    <i class="fas fa-user-tie nav-icon"></i>
                    <span class="nav-text">Staff</span>
                </a>
                <a href="counselors.html" class="nav-item">
                    <i class="fas fa-phone nav-icon"></i>
                    <span class="nav-text">Counselors</span>
                </a>
                <a href="courses.html" class="nav-item">
                    <i class="fas fa-book-open nav-icon"></i>
                    <span class="nav-text">Courses & Academics</span>
                </a>
                <a href="fees.html" class="nav-item">
                    <i class="fas fa-credit-card nav-icon"></i>
                    <span class="nav-text">Fee Management</span>
                </a>
                <a href="communication.html" class="nav-item">
                    <i class="fas fa-comments nav-icon"></i>
                    <span class="nav-text">Communication</span>
                </a>
                <a href="advertisement.html" class="nav-item">
                    <i class="fas fa-bullhorn nav-icon"></i>
                    <span class="nav-text">Advertisement</span>
                </a>
                <a href="alumni.html" class="nav-item">
                    <i class="fas fa-graduation-cap nav-icon"></i>
                    <span class="nav-text">Alumni Portal</span>
                </a>
                <a href="scholarship.html" class="nav-item">
                    <i class="fas fa-shield-alt nav-icon"></i>
                    <span class="nav-text">Scholarship & Offers</span>
                </a>
                <a href="referral.html" class="nav-item">
                    <i class="fas fa-share-alt nav-icon"></i>
                    <span class="nav-text">Referral Program</span>
                </a>
                <a href="analytics.html" class="nav-item">
                    <i class="fas fa-chart-bar nav-icon"></i>
                    <span class="nav-text">Analytics & Reports</span>
                </a>
                <a href="notifications.html" class="nav-item">
                    <i class="fas fa-bell nav-icon"></i>
                    <span class="nav-text">Notifications</span>
                </a>
                <a href="settings.html" class="nav-item">
                    <i class="fas fa-cog nav-icon"></i>
                    <span class="nav-text">Settings</span>
                </a>
                <a href="cloud.html" class="nav-item">
                    <i class="fas fa-cloud nav-icon"></i>
                    <span class="nav-text">Cloud</span>
                </a>
                <a href="expenses.html" class="nav-item">
                    <i class="fas fa-wallet nav-icon"></i>
                    <span class="nav-text">Expenses</span>
                </a>
                <a href="finance.html" class="nav-item">
                    <i class="fas fa-chart-line nav-icon"></i>
                    <span class="nav-text">Finance</span>
                </a>
            </nav>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Top Header -->
            <div class="top-header">
                <div class="header-search">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" placeholder="Search staff members...">
                </div>
                
                <div class="header-right">
                    <!-- Universal Notification Dropdown -->
                    <div class="notification-dropdown">
                        <div class="notification-bell" id="notificationBell">
                            <i class="fas fa-bell"></i>
                            <div class="notification-badge" id="notificationBadge">0</div>
                        </div>
                        
                        <div class="notification-panel" id="notificationPanel">
                            <div class="notification-panel-header">
                                <div class="notification-panel-title">Notifications</div>
                                <button class="notification-clear-all" id="clearAllNotifications">Clear All</button>
                            </div>
                            
                            <div class="notification-panel-body" id="notificationPanelBody">
                                <div class="notification-empty">
                                    <div class="notification-empty-icon">
                                        <i class="fas fa-bell-slash"></i>
                                    </div>
                                    <div class="notification-empty-text">No notifications yet</div>
                                </div>
                            </div>
                            
                            <div class="notification-panel-footer">
                                <a href="notifications.html" class="notification-view-all">View All Notifications</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="user-profile">
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-info">
                            <div class="user-name">Admin User</div>
                            <div class="user-role">Administrator</div>
                        </div>
                        <i class="fas fa-chevron-down user-dropdown"></i>
                    </div>
                </div>
            </div>

            <!-- Page Title -->
            <div class="page-title">Staff Management</div>
            <div class="page-subtitle">Manage staff information, roles, and performance</div>

            <!-- Staff Statistics Cards -->
            <div class="staff-stats">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalStaff">0</h3>
                        <p>Total Staff</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="activeStaff">0</h3>
                        <p>Active Staff</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-user-clock"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="newStaff">0</h3>
                        <p>New This Month</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon purple">
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="teachingStaff">0</h3>
                        <p>Teaching Staff</p>
                    </div>
                </div>
            </div>

            <!-- Controls Section -->
            <div class="staff-controls">
                <div class="controls-header">
                    <div class="controls-title">Staff Controls</div>
                    <div class="controls-actions">
                        <button class="btn btn-primary" onclick="openAddStaffModal()">
                            <i class="fas fa-plus"></i>
                            Add New Staff
                        </button>
                        <button class="btn btn-success" onclick="openBulkUploadModal()">
                            <i class="fas fa-upload"></i>
                            Bulk Upload
                        </button>
                        <button class="btn btn-outline" onclick="exportStaffData()">
                            <i class="fas fa-download"></i>
                            Export Data
                        </button>
                    </div>
                </div>
                
                <div class="search-filters">
                    <div class="filter-group">
                        <label class="filter-label">Search</label>
                        <input type="text" class="form-control" id="searchInput" placeholder="Search by name, ID, or phone...">
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Department</label>
                        <select class="filter-select" id="departmentFilter">
                            <option value="">All Departments</option>
                            <option value="Teaching">Teaching</option>
                            <option value="Administration">Administration</option>
                            <option value="Support">Support</option>
                            <option value="Management">Management</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Position</label>
                        <select class="filter-select" id="positionFilter">
                            <option value="">All Positions</option>
                            <option value="Teacher">Teacher</option>
                            <option value="Administrator">Administrator</option>
                            <option value="Manager">Manager</option>
                            <option value="Support Staff">Support Staff</option>
                            <option value="Principal">Principal</option>
                            <option value="Vice Principal">Vice Principal</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Status</label>
                        <select class="filter-select" id="statusFilter">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="on_leave">On Leave</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Experience</label>
                        <select class="filter-select" id="experienceFilter">
                            <option value="">All Experience</option>
                            <option value="entry">Entry Level (0-2 years)</option>
                            <option value="mid">Mid Level (3-5 years)</option>
                            <option value="senior">Senior Level (6-10 years)</option>
                            <option value="expert">Expert Level (10+ years)</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">View</label>
                        <select class="filter-select" id="viewFilter">
                            <option value="table">Table View</option>
                            <option value="grid">Grid View</option>
                        </select>
                    </div>
                </div>

                <!-- Advanced Filters Section -->
                <div class="advanced-filters">
                    <div class="advanced-filters-header">
                        <button class="btn btn-outline-primary btn-sm" id="toggleAdvancedFilters">
                            <i class="fas fa-filter"></i>
                            Advanced Filters
                            <i class="fas fa-chevron-down toggle-icon"></i>
                        </button>
                        <div class="quick-filters">
                            <span class="quick-filter-label">Quick Filters:</span>
                            <button class="quick-filter-btn" data-filter="recently_hired">
                                <i class="fas fa-clock"></i>
                                Recently Hired
                            </button>
                            <button class="quick-filter-btn" data-filter="birthdays_this_month">
                                <i class="fas fa-birthday-cake"></i>
                                Birthdays This Month
                            </button>
                            <button class="quick-filter-btn" data-filter="senior_staff">
                                <i class="fas fa-star"></i>
                                Senior Staff
                            </button>
                            <button class="quick-filter-btn" data-filter="high_performers">
                                <i class="fas fa-trophy"></i>
                                Top Performers
                            </button>
                        </div>
                    </div>
                    
                    <div class="advanced-filters-content" id="advancedFiltersContent">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label class="filter-label">Hire Date Range</label>
                                <div class="date-range-inputs">
                                    <input type="date" class="form-control" id="hireDateFrom" placeholder="From">
                                    <span class="date-separator">to</span>
                                    <input type="date" class="form-control" id="hireDateTo" placeholder="To">
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label class="filter-label">Age Range</label>
                                <div class="range-inputs">
                                    <input type="number" class="form-control" id="ageFrom" placeholder="From" min="18" max="80">
                                    <span class="range-separator">to</span>
                                    <input type="number" class="form-control" id="ageTo" placeholder="To" min="18" max="80">
                                </div>
                            </div>
                        </div>
                        
                        <div class="filter-row">
                            <div class="filter-group">
                                <label class="filter-label">Salary Range</label>
                                <div class="range-inputs">
                                    <input type="number" class="form-control" id="salaryFrom" placeholder="Min Salary" min="0" step="1000">
                                    <span class="range-separator">to</span>
                                    <input type="number" class="form-control" id="salaryTo" placeholder="Max Salary" min="0" step="1000">
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label class="filter-label">Gender</label>
                                <select class="filter-select" id="genderFilter">
                                    <option value="">All Genders</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="filter-actions">
                            <button class="btn btn-primary btn-sm" id="applyAdvancedFilters">
                                <i class="fas fa-check"></i>
                                Apply Filters
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" id="clearAdvancedFilters">
                                <i class="fas fa-times"></i>
                                Clear All
                            </button>
                            <button class="btn btn-outline-info btn-sm" id="saveFilterPreset">
                                <i class="fas fa-save"></i>
                                Save Preset
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Staff Table View -->
                        <!-- Staff Table View -->
            <div class="content-card" id="tableView">
                <div class="card-header">
                    <div class="card-title">Staff List</div>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-sm" onclick="refreshStaffList()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                        <button class="btn btn-danger btn-sm" id="bulk-delete-btn" style="display: none;">
                            <i class="fas fa-trash"></i>
                            Delete Selected (<span class="selected-count">0</span>)
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="table" id="staffTable">
                        <thead>
                            <tr>
                                <th style="width: 50px;">
                                    <input type="checkbox" id="select-all-staff">
                                </th>
                                <th>Staff Member</th>
                                <th>Position</th>
                                <th>Department</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="staffTableBody">
                            <!-- Staff data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Staff Grid View -->
            <div class="content-card" id="gridView" style="display: none;">
                <div class="card-header">
                    <div class="card-title">Staff Grid</div>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-sm" onclick="refreshStaffList()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>
                </div>
                
                <div id="staffGrid" class="staff-grid">
                    <!-- Grid cards will be populated here -->
                </div>
            </div>

            <!-- Staff Grid View -->
            <div class="content-card" id="gridView" style="display: none;">
                <div class="card-header">
                    <div class="card-title">Staff Grid</div>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-sm" onclick="refreshStaffList()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>
                </div>
                
                <div id="staffGrid" class="staff-grid">
                    <!-- Grid cards will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add Staff Modal -->
    <div id="addStaffModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Add New Staff Member</div>
                <button class="modal-close" onclick="closeAddStaffModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addStaffForm">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Full Name *</label>
                        <input type="text" class="form-control" id="staffName" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Phone Number *</label>
                        <input type="tel" class="form-control" id="staffPhone" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Email *</label>
                        <input type="email" class="form-control" id="staffEmail" required>
                    </div>
                    
                                        <div class="form-group">
                        <label class="form-label">Department *</label>
                        <select class="form-control" id="staffDepartment" required>
                            <option value="">Select Department</option>
                            <option value="Academic">Academic</option>
                            <option value="Administration">Administration</option>
                            <option value="IT">Information Technology</option>
                            <option value="Finance">Finance</option>
                            <option value="Marketing">Marketing</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Position *</label>
                        <input type="text" class="form-control" id="staffPosition" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Employee ID</label>
                        <div style="display: flex; gap: 8px;">
                            <input type="text" class="form-control" id="staffEmployeeId" placeholder="Auto-generated (MTS001, MTS002...)" readonly style="flex: 1;">
                            <button type="button" class="btn btn-outline btn-sm" onclick="generateEmployeeId()" title="Generate New ID">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <small style="color: #9CA3AF; font-size: 12px; margin-top: 4px; display: block;">
                            <i class="fas fa-info-circle"></i> Employee ID is automatically generated (MTS001, MTS002, MTS003...)
                        </small>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Date of Birth</label>
                        <input type="date" class="form-control" id="staffDOB">
                    </div>
                    
                                        <div class="form-group">
                        <label class="form-label">Gender</label>
                        <select class="form-control" id="staffGender">
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Nationality</label>
                        <input type="text" class="form-control" id="staffNationality">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Present Address</label>
                        <textarea class="form-control" id="staffPresentAddress" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Permanent Address</label>
                        <textarea class="form-control" id="staffPermanentAddress" rows="3"></textarea>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Educational Qualifications</label>
                        <textarea class="form-control" id="staffEducation" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Work Experience</label>
                        <textarea class="form-control" id="staffExperience" rows="3" placeholder="Previous work experience..."></textarea>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Joining Date *</label>
                        <input type="date" class="form-control" id="staffJoiningDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Salary (₹)</label>
                        <input type="number" class="form-control" id="staffSalary" min="0" step="100">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Emergency Contact</label>
                        <input type="tel" class="form-control" id="staffEmergencyContact">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Photo URL</label>
                        <input type="url" class="form-control" id="staffPhotoURL" placeholder="https://example.com/photo.jpg">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Additional Notes</label>
                    <textarea class="form-control" id="staffNotes" rows="3" placeholder="Any additional information..."></textarea>
                </div>
                
                <div class="card-actions" style="justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-outline" onclick="closeAddStaffModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Staff Member</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Bulk Upload Modal -->
    <div id="bulkUploadModal" class="modal">
        <div class="modal-content bulk-upload-modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-cloud-upload-alt" style="color: #10B981; margin-right: 8px;"></i>
                    Bulk Upload Staff
                </div>
                <button class="modal-close" onclick="closeBulkUploadModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="bulk-upload-container">
                <!-- Progress Steps -->
                <div class="upload-steps">
                    <div class="step active" id="step1">
                        <div class="step-number">1</div>
                        <div class="step-label">Download Template</div>
                    </div>
                    <div class="step-line"></div>
                    <div class="step" id="step2">
                        <div class="step-number">2</div>
                        <div class="step-label">Prepare Data</div>
                    </div>
                    <div class="step-line"></div>
                    <div class="step" id="step3">
                        <div class="step-number">3</div>
                        <div class="step-label">Upload File</div>
                    </div>
                    <div class="step-line"></div>
                    <div class="step" id="step4">
                        <div class="step-number">4</div>
                        <div class="step-label">Review & Import</div>
                    </div>
                </div>

                <!-- Step 1: Instructions & Template Download -->
                <div class="upload-step-content" id="stepContent1">
                    <div class="step-header">
                        <h3><i class="fas fa-download"></i> Download Template</h3>
                        <p>Start by downloading our Excel template with the correct format</p>
                    </div>
                    
                    <div class="template-info">
                        <div class="info-card">
                            <div class="info-icon">
                                <i class="fas fa-file-excel"></i>
                            </div>
                            <div class="info-content">
                                <h4>Staff Template.csv</h4>
                                <p>Pre-formatted template with all required columns and sample data</p>
                                <ul class="template-features">
                                    <li><i class="fas fa-check"></i> 17 staff information fields</li>
                                    <li><i class="fas fa-check"></i> Sample data for reference</li>
                                    <li><i class="fas fa-check"></i> Validation guidelines</li>
                                    <li><i class="fas fa-check"></i> Auto-generated Employee IDs</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="template-actions">
                        <button class="btn btn-success btn-lg" onclick="downloadTemplate()">
                            <i class="fas fa-download"></i>
                            Download Template
                        </button>
                        <button class="btn btn-outline" onclick="showSampleData()">
                            <i class="fas fa-eye"></i>
                            View Sample Format
                        </button>
                        <button class="btn btn-secondary" onclick="skipTemplate()">
                            <i class="fas fa-forward"></i>
                            Skip Template (Already Have Format)
                        </button>
                    </div>
                </div>

                <!-- Step 2: Data Preparation Guidelines -->
                <div class="upload-step-content" id="stepContent2" style="display: none;">
                    <div class="step-header">
                        <h3><i class="fas fa-edit"></i> Prepare Your Data</h3>
                        <p>Follow these guidelines to ensure successful import</p>
                    </div>
                    
                    <div class="guidelines-grid">
                        <div class="guideline-card">
                            <div class="guideline-icon required">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="guideline-content">
                                <h4>Required Fields</h4>
                                <ul>
                                    <li>Full Name</li>
                                    <li>Phone Number</li>
                                    <li>Email Address</li>
                                    <li>Department</li>
                                    <li>Position</li>
                                    <li>Joining Date</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="guideline-card">
                            <div class="guideline-icon format">
                                <i class="fas fa-calendar"></i>
                            </div>
                            <div class="guideline-content">
                                <h4>Date Format</h4>
                                <ul>
                                    <li>Use DD/MM/YYYY format</li>
                                    <li>Example: 15/01/2023</li>
                                    <li>Date of Birth: Optional</li>
                                    <li>Joining Date: Required</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="guideline-card">
                            <div class="guideline-icon validation">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="guideline-content">
                                <h4>Validation Rules</h4>
                                <ul>
                                    <li>Email must be unique</li>
                                    <li>Phone: Include country code</li>
                                    <li>No special characters in names</li>
                                    <li>Salary: Numbers only</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="guideline-card">
                            <div class="guideline-icon departments">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="guideline-content">
                                <h4>Department Options</h4>
                                <ul>
                                    <li>Academic</li>
                                    <li>Administration</li>
                                    <li>Information Technology</li>
                                    <li>Finance</li>
                                    <li>Marketing</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="step-navigation">
                        <button class="btn btn-outline" onclick="previousStep()">
                            <i class="fas fa-arrow-left"></i>
                            Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextStep()">
                            Next Step
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 3: File Upload -->
                <div class="upload-step-content" id="stepContent3" style="display: none;">
                    <div class="step-header">
                        <h3><i class="fas fa-cloud-upload-alt"></i> Upload Your File</h3>
                        <p>Drag and drop your CSV file or click to browse</p>
                    </div>
                    
                    <div class="upload-area" onclick="document.getElementById('csvFile').click()" ondrop="handleFileDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                        <input type="file" id="csvFile" accept=".csv" onchange="handleFileUpload(event)" style="display: none;">
                        
                        <div class="upload-content">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="upload-text">
                                <h4>Drop your CSV file here</h4>
                                <p>or <span class="upload-link">click to browse</span></p>
                            </div>
                            <div class="upload-requirements">
                                <small>
                                    <i class="fas fa-info-circle"></i>
                                    Supports: CSV files up to 10MB, Max 1000 records
                                </small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="upload-status" id="uploadStatus" style="display: none;">
                        <div class="status-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="status-content">
                            <h4 id="fileName"></h4>
                            <p id="fileInfo"></p>
                        </div>
                        <div class="status-actions">
                            <button class="btn btn-outline btn-sm" onclick="clearFileUpload()">
                                <i class="fas fa-times"></i>
                                Remove
                            </button>
                        </div>
                    </div>
                    
                    <div class="step-navigation">
                        <button class="btn btn-outline" onclick="previousStep()">
                            <i class="fas fa-arrow-left"></i>
                            Previous
                        </button>
                        <button class="btn btn-primary" id="proceedToReview" onclick="nextStep()" disabled>
                            Review Data
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 4: Preview & Import -->
                <div class="upload-step-content" id="stepContent4" style="display: none;">
                    <div class="step-header">
                        <h3><i class="fas fa-eye"></i> Review & Import</h3>
                        <p>Review your data before importing to the system</p>
                    </div>
                    
                    <div class="preview-stats" id="previewStats" style="display: none;">
                        <div class="stat-item">
                            <div class="stat-number" id="totalRecords">0</div>
                            <div class="stat-label">Total Records</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="validRecords">0</div>
                            <div class="stat-label">Valid Records</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="errorRecords">0</div>
                            <div class="stat-label">Errors Found</div>
                        </div>
                    </div>
                    
                    <div id="csvPreview" class="csv-preview" style="display: none;">
                        <div class="preview-header">
                            <h4>Data Preview</h4>
                            <div class="preview-controls">
                                <button class="btn btn-outline btn-sm" onclick="showErrorsOnly()">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Show Errors Only
                                </button>
                                <button class="btn btn-outline btn-sm" onclick="showAllRecords()">
                                    <i class="fas fa-list"></i>
                                    Show All
                                </button>
                            </div>
                        </div>
                        
                        <div id="previewTable" class="preview-table-container">
                            <!-- Preview table will be shown here -->
                        </div>
                        
                        <div class="import-actions">
                            <div class="import-options">
                                <label class="checkbox-container">
                                    <input type="checkbox" id="skipErrors" checked>
                                    <span class="checkmark"></span>
                                    Skip records with errors
                                </label>
                                <label class="checkbox-container">
                                    <input type="checkbox" id="sendNotification">
                                    <span class="checkmark"></span>
                                    Send email notification after import
                                </label>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-outline" onclick="previousStep()">
                                    <i class="fas fa-arrow-left"></i>
                                    Back to Upload
                                </button>
                                <button class="btn btn-success btn-lg" onclick="processBulkUpload()" id="importButton">
                                    <i class="fas fa-upload"></i>
                                    Import Staff Data
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="importProgress" class="import-progress" style="display: none;">
                        <div class="progress-header">
                            <h4>Importing Staff Data...</h4>
                            <div class="progress-stats">
                                <span id="progressText">0 of 0 records processed</span>
                            </div>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                        </div>
                        
                        <div class="progress-details" id="progressDetails">
                            <div class="detail-item">
                                <span class="detail-label">Processed:</span>
                                <span class="detail-value" id="processedCount">0</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Successful:</span>
                                <span class="detail-value success" id="successCount">0</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Errors:</span>
                                <span class="detail-value error" id="errorCount">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="importResults" class="import-results" style="display: none;">
                        <div class="results-header">
                            <div class="results-icon success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3>Import Completed!</h3>
                        </div>
                        
                        <div class="results-summary" id="resultsSummary">
                            <!-- Results will be populated here -->
                        </div>
                        
                        <div class="results-actions">
                            <button class="btn btn-primary" onclick="closeBulkUploadModal(); refreshStaffList();">
                                <i class="fas fa-list"></i>
                                View Staff List
                            </button>
                            <button class="btn btn-outline" onclick="downloadImportLog()">
                                <i class="fas fa-download"></i>
                                Download Log
                            </button>
                            <button class="btn btn-outline" onclick="resetBulkUpload()">
                                <i class="fas fa-plus"></i>
                                Import More Staff
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sample Data Modal -->
    <div id="sampleDataModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-table" style="color: #3B82F6; margin-right: 8px;"></i>
                    Sample Data Format
                </div>
                <button class="modal-close" onclick="closeSampleDataModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="sample-data-content">
                <p style="margin-bottom: 20px; color: #9CA3AF;">
                    This is how your CSV data should be formatted. Employee IDs will be automatically generated during import.
                </p>
                
                <div class="sample-table-container">
                    <table class="sample-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Department</th>
                                <th>Position</th>
                                <th>Joining Date</th>
                                <th>Salary</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>John Doe</td>
                                <td>+91-9876543210</td>
                                <td>john.doe@microtechcenter.in</td>
                                <td>Academic</td>
                                <td>Senior Instructor</td>
                                <td>15/01/2023</td>
                                <td>45000</td>
                            </tr>
                            <tr>
                                <td>Jane Smith</td>
                                <td>+91-9876543211</td>
                                <td>jane.smith@microtechcenter.in</td>
                                <td>Administration</td>
                                <td>Office Manager</td>
                                <td>01/02/2023</td>
                                <td>35000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="sample-notes">
                    <h4><i class="fas fa-lightbulb"></i> Important Notes:</h4>
                    <ul>
                        <li>All dates must be in DD/MM/YYYY format (e.g., 15/01/2023)</li>
                        <li>Email addresses must be unique across all staff</li>
                        <li>Phone numbers should include country code</li>
                        <li>Employee IDs are automatically generated (MTS001, MTS002, etc.)</li>
                        <li>Optional fields can be left empty</li>
                    </ul>
                </div>
            </div>
            
            <div class="card-actions" style="justify-content: flex-end; margin-top: 20px;">
                <button type="button" class="btn btn-outline" onclick="closeSampleDataModal()">Close</button>
                <button type="button" class="btn btn-primary" onclick="downloadTemplate(); closeSampleDataModal();">
                    <i class="fas fa-download"></i>
                    Download Template
                </button>
            </div>
        </div>
    </div>

    <!-- Staff Details Modal -->
    <div id="staffDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Staff Details</div>
                <button class="modal-close" onclick="closeStaffDetailsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="staffDetailsContent">
                <!-- Staff details will be populated here -->
            </div>
            
            <!-- Action buttons will be added dynamically by viewStaffDetails function -->
        </div>
    </div>

    <!-- Bulk Delete Password Modal -->
    <div id="bulk-delete-password-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <div class="modal-title">Confirm Bulk Delete</div>
                <button class="modal-close" id="bulk-delete-password-modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <p style="margin-bottom: 20px; color: #EF4444;">
                    <i class="fas fa-exclamation-triangle"></i>
                    You are about to delete <span id="bulk-delete-count">0</span> staff member(s). This action cannot be undone.
                </p>
                
                <div class="form-group">
                    <label class="form-label">Enter admin password to confirm:</label>
                    <input type="password" class="form-control" id="bulk-delete-password" placeholder="Enter password">
                    <div id="password-error" style="color: #EF4444; font-size: 12px; margin-top: 8px; display: none;">
                        Incorrect password. Please try again.
                    </div>
                </div>
            </div>
            
            <div class="card-actions" style="justify-content: flex-end; margin-top: 20px;">
                <button type="button" class="btn btn-outline" id="bulk-delete-password-cancel">Cancel</button>
                <button type="button" class="btn btn-danger" id="bulk-delete-password-confirm">Delete Staff</button>
            </div>
        </div>
    </div>

    <!-- Toast notification container -->
    <div id="toast-container" style="position:fixed;top:24px;right:24px;z-index:9999;"></div>
    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <script src="firebase.js"></script>
    <script type="module" src="js/toast.js"></script>
    <script type="module" src="notification-manager.js"></script>
    <script type="module" src="js/staff.js"></script>
</body>
</html>
